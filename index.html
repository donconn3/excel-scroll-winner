<!DOCTYPE html>
<html lang="en" >
<head>
<meta charset="UTF-8">
<title>CodePen - Vertically-scrolling Text</title>
<script src="https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js"></script> 
<script src="https://unpkg.com/write-excel-file@1.x/bundle/write-excel-file.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<link rel="stylesheet" href="./style.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!--How to use the page:
File Format:
1) The file format must be .xls or .xlsx
2) ONLY Column 1 and Column 2 of the excel sheet is displayed (firstName lastName) but column 3 is also read
3) Empty Cells throw an error so make sure Col 1, Col 2, and Col 3 are all filled
4) Col 3 can be any information you want (phone, email, raffle #, ticket #, etc.)
i) The program has worked with over 28,000 rows with 2 columns & over 14,000 rows with 3 columns

Operation:
1) Upload your file
2) Click "Pick Name" (winner is the last person in the 'players' array created below. Winner(s) is logged to the console and in localStorage)
3) Once the names stop scrolling, you will have your winner and "Congratualtions" will appear
4) To draw another name, click "New Drawing" and then repeat Step 2
5.0) To download the Winner information, click hamburger icon and then click "Download Winners".
5.1) This will download an excel sheet to your computer with the: DATE+TIME each winner was picked, NAME of the winner(s),(phone, email, raffle #, ticket #, etc.) of winner(s) 
i) DO NOT CLICK "CLEAR LOCAL STORAGE" BEFORE YOU CLICK "DOWNLOAD WINNERS" OR ALL WINNER INFORMATION WILL BE LOST!
ii) To start a new drawing with a new list, Complete Step 5, then hit click "Clear Local Storage", and then repeat from Step 1

How it Works:
1) The "readexcelfile" reads each row making an array-of-arrays (sheet = main array, each row = sub-array)
2) A "player" is created and assigned a random number which indicates their index position in the array
3.0) While the "counter" is less than the number of rows (numOfROws - 1), 
    the "player" is checked against an exclusion array that checks to see if that "player" has been picked already
3.1) If the "player" has been picked, then the loop restarts
3.2) If the "player" has NOT been picked, then a "person" is created using the "player" index 
    and added to the "players" array and the "counter" goes up by 1
4) Once the "players" array is finished, a for-loop creates a <li> tag for each "person"
5) When the "Pick Name" button is clicked, the list of names is scrolled until the "winner" (last <li> tag) appears
6) When the "New Drawing" button is clicked, the "players" and  "exclusions" arrays are emptied, and the internal "counter" is reset to 0
-->
</head>
<body id="grad1">
<!-- partial:index.partial.html -->
<div id="menu" class="row">
  <div id="menu-btn" class="panel panel-default col-xs-12">
    <div class="panel-heading">
      <h3 class="panel-title ">
        <button id="toggle" type="button" class="btn btn-default" aria-label="Left Align" onClick="swapClass()"> <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span> </button>
      </h3>
    </div>
  </div>
  <!--  <div class="panel panel-default col-xs-12">-->
  <div id="panel-body" class="panel">
    <div class="panel-bod ">
      <div id="file" class="form-group">
        <label for="input">Choose file</label>
        <input type="file" id="input" onchange="pickName()">
      </div>
      <div class="trash">
        <button type="button" class="btn btn-danger" aria-label="Left Align" onclick="clearLocalStorage()"> <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Clear Local Storage </button>
      </div>
      <br>
      <div class="download">
        <button type="button" class="btn btn-info" aria-label="Left Align" onclick="exportPage()"> <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> Download Winners </button>
      </div>
		<br>
      <div class="form-group">
        <label for="input">Raffle Title</label><br>
        <input placeholder="Enter Title Here" type="text" id="raffle-title">
      </div>
	  <div class="form-group">
        <label id="duration" for="input">Duration:</label><br>
        <input type="range" class="form-range" min="0" value="5" max="20" step="1" id="customRange3">
      </div>
    </div>
  </div>
</div>
<div class="container" style="padding-top: 25px;">
  <div class="row">
    <div class="col-xs-12">
      <h1 id="title" class="text-center text-danger">Change Me</h1>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <div class="box">
        <ul id ="names" class="">
          <li></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <div class="message">
        <h1 id="congrats" class="text-center bg-success">Congratulations!</h1>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 no-padding">
      <button id="get-data" type="button" class="btn btn-success"><span class="glyphicon glyphicon-hand-up" aria-hidden="true"></span> PICK NAME </button>
      <button id="reset" type="button" class="btn btn-danger"><span class="glyphicon glyphicon-repeat" aria-hidden="true"></span> NEW DRAWING </button>
    </div>
  </div>
</div>
<script src="/index.js"></script>
</body>
</html>
